<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dune Awakening - Mi Base</title>
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/admin.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff8c00">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('PWA lista para Arrakis', reg))
                    .catch(err => console.log('Error PWA', err));
            });
        }
    </script>
</head>

<body class="dune-dark">

    <nav class="main-nav">
        <a href="index.html">Calculadora</a>
        <a href="base.html" class="active">Mi Base</a>
        <a href="admin.html">Administrador</a>
    </nav>

    <main class="container">
        <h1>Estado de la Base</h1>

        <div class="base-layout">
            <aside class="sidebar-controls">
                <section class="card">
                    <h2><i class="fas fa-layer-group"></i> Filtros de Mapa</h2>
                    <div class="form-group">
                        <label>Seleccionar Planta:</label>
                        <select id="floorSelect">
                            <option value="p0">Planta Baja (P0)</option>
                            <option value="p1">Piso 1 (P1)</option>
                            <option value="p2">Piso 2 (P2)</option>
                        </select>
                    </div>
                    <div class="filter-group" style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn-secondary" style="flex: 1;" onclick="filterMap('todas')">Todas</button>
                        <button class="btn-secondary" style="flex: 1;" onclick="filterMap('agua')">Agua</button>
                    </div>
                </section>

                <section class="card">
                    <h2><i class="fas fa-microchip"></i> Censo de MÃ¡quinas</h2>
                    <div id="censusList">
                        <p style="color: #666; font-size: 0.9rem;">Cargando inventario...</p>
                    </div>
                </section>
            </aside>

            <section class="map-area">
                <div class="map-container" id="mapWrapper" style="cursor: crosshair;">
                    <img src="https://via.placeholder.com/1000x800/111/ff8c00?text=Sube+tu+plano+en+Base.js" id="mapImage" alt="Plano de la base">
                    <div id="markersLayer"></div>
                </div>

                <div class="card" style="margin-top: 15px; border-left-color: #00aaff;">
                    <p style="font-size: 0.85rem; color: #aaa;">
                        <i class="fas fa-mouse-pointer" style="color: #00aaff;"></i> 
                        Haz clic en el plano para obtener coordenadas exactas.
                    </p>
                    <div id="coordDisplay" style="margin-top: 10px; display: none; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">
                        <span style="color: #00aaff; font-family: 'Orbitron';">COORDENADAS:</span> 
                        <strong id="currentCoords" style="margin-left: 10px; color: #fff;">X: 0%, Y: 0%</strong>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script src="js/db.js"></script>
    <script src="js/base.js"></script>
</body>

</html>